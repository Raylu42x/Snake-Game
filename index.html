<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <style>
      body {margin:0;display:flex;flex-direction:column;align-items:center;
            justify-content:center;background:#111;color:white;font-family:sans-serif;}
      canvas {border:3px solid #0f0;margin:10px;}
      .buttons {display:grid;grid-template-columns:repeat(3,60px);gap:5px;}
      button {height:60px;width:60px;font-size:20px;border-radius:10px;border:none;
              background:#333;color:#0f0;}
    </style>
  </head>
  <body>
    <canvas id="c" width="300" height="300"></canvas>
    <div class="buttons">
      <div></div><button id="up">▲</button><div></div>
      <button id="left">◀</button><button id="down">▼</button><button id="right">▶</button>
    </div>
    <script>
      const ctx=c.getContext("2d");
      const size=15, cells=300/size;
      let x=10,y=10,dx=1,dy=0,trail=[[x,y]],len=5,fx=5,fy=5;

      function draw(){
        x=(x+dx+cells)%cells;
        y=(y+dy+cells)%cells;
        trail.push([x,y]);
        if(x===fx&&y===fy){len++;fx=Math.random()*cells|0;fy=Math.random()*cells|0;}
        while(trail.length>len)trail.shift();
        ctx.fillStyle="black";ctx.fillRect(0,0,300,300);
        ctx.fillStyle="lime";for(const [px,py] of trail)ctx.fillRect(px*size,py*size,size-1,size-1);
        ctx.fillStyle="red";ctx.fillRect(fx*size,fy*size,size-1,size-1);
      }
      setInterval(draw,100);

      function turn(nx,ny){if(nx===-dx&&ny===-dy)return;dx=nx;dy=ny;}
      up.onclick=()=>turn(0,-1);
      down.onclick=()=>turn(0,1);
      left.onclick=()=>turn(-1,0);
      right.onclick=()=>turn(1,0);

      // swipe control
      let sx,sy;
      c.addEventListener("touchstart",e=>{sx=e.touches[0].clientX;sy=e.touches[0].clientY;});
      c.addEventListener("touchend",e=>{
        let dx2=e.changedTouches[0].clientX-sx, dy2=e.changedTouches[0].clientY-sy;
        if(Math.abs(dx2)>Math.abs(dy2)) turn(dx2>0?1:-1,0);
        else turn(0,dy2>0?1:-1);
      });
    </script>
  </body>
</html>
